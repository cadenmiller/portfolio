<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Final Draft</title>
    <style>
        html, body, 
        
        #extentDiv, #contentDiv, #secviewsDiv{
            padding:0;
            margin:0;
            height:100%;
            width:100%;
        }
        
        #legendDiv {
            border: 1px solid black;
            padding: 0;
                float: left;
                left: 0;
            margin: 0;
            height: 100%;
            width: 20%;
            overflow-y: auto;
            overflow-x: hidden;
        }
        #viewDiv1 {
            padding: 0;
                float: left;
                left: 0;
            margin: 0;
            height: 100%;
            width: 55%
        }
        
        #viewDiv {
            padding: 0;
                float: right;
                left: 0;
            margin: 0;
            height: 100%;
            width: 44%
        }
        
        #viewDiv2 {
            padding: 0;
                float: top;
                left: 0;
            margin: 0;
            height: 44.75%;
            width: 99.5%
        }
        #viewDiv3 {
            padding: 0;
                float: left;
                left: 0;
            margin: 0;
            height: 45.75%;
            width: 99.5%
        }
        #allviewDiv {
            padding: 0;
            background-color: black;
                float: right;
                left: 0;
            margin: 0;
            height: 100%;
            width: 79%
        }
        #contentDiv {
            padding: 0;
            background-color: black;
                float: right;
                left: 0;
            margin: 0;
            height: 90%;
            width: 100%
        }
        titlesDiv{
            float: bottom;
            height: 5%;
            width: 50%;
            background-color: black;
            color: white;
            text-align: center;
            font-weight: 400;
            font-size: 20px
        }
         #maintitleDiv{
            float: left;
            height: 25px;
            width: 40%;
            background-color: black;
            color: white;
            text-align: center;
            font-weight: 400;
            font-size: 15px
        }
        #legendtitleDiv{
            float: left;
            height: 25px;
            width: 20%;
            background-color: black;
            color: white;
            text-align: center;
            font-weight: 400;
            font-size: 15px
        }
        #secondarytitleDiv{
            float: left;
            height: 25px;
            width: 40%;
            background-color: black;
            color: white;
            text-align: center;
            font-weight: 400;
            font-size: 15px
        }
        #povertytitleDiv{
            float: bottom;
            height: 5%;
            width: 99.5%;
            background-color: black;
            color: white;
            text-align: center;
            font-weight: 400;
            font-size: 15px
        }
         #header {
            width: 100%;
            background-color: floralwhite;
            height: 10%;
            text-align: center;
            color: black;
        }
        #header1 {
            width: 100%;
            background-color: floralwhite;
            height: 95%;
            text-align: center;
            color: black;
        }
    </style>
    
    <link rel="stylesheet" href="https://js.arcgis.com/4.34/esri/themes/dark/main.css">
    <script src="https://js.arcgis.com/4.34/"></script>
    
    <script>
    require([
        "esri/config",
        "esri/core/urlUtils",
        "esri/Map",
        "esri/Basemap",
        "esri/views/MapView",
        "esri/layers/FeatureLayer",
        "esri/widgets/Legend",
        "esri/widgets/Search",
        "esri/widgets/LayerList",
        "esri/core/reactiveUtils",
        "esri/geometry/Point",
        "esri/widgets/LayerList"
    ], function(esriConfig, urlUtils, Map, Basemap, MapView, FeatureLayer, Legend, Search, LayerList, reactiveUtils, Point, LayerList)
           {

//Map 1: 
        var map = new Map({
                basemap: "gray-vector"
            });
            var view = new MapView({
                container: "viewDiv1",
                map: map,
                zoom: 7,
                center: [-82.5, 40],
            });
        
     
        
          var snaptracts = new FeatureLayer({
        portalItem: {
          id: "5a348c1010a8485d9aa8260099f9a816"
        },
          outFields: ["*"],
  title: "SNAP Participation Rates",
  renderer: {
    type: "class-breaks",
    field: "lasnaphalfshare",
    classBreakInfos: [
      { minValue: 0,
        maxValue: 10,
        symbol: {
          type: "simple-fill",
          color: "#f7f7e8",
          outline: { color: "gray", width: 0.2 }
        },
        label: "0 - 10%"
      },
      {
        minValue: 10,
        maxValue: 20,
        symbol: {
          type: "simple-fill",
          color: "#b9d7c3",
          outline: { color: "gray", width: 0.2 }
        },
        label: "10 - 20%"
      },
      {
        minValue: 20,
        maxValue: 30,
        symbol: {
          type: "simple-fill",
          color: "#75b5ad",
          outline: { color: "gray", width: 0.2 }
        },
        label: "20 - 30%"
      },
      {
        minValue: 30,
        maxValue: 40,
        symbol: {
          type: "simple-fill",
          color: "#46899f",
          outline: { color: "gray", width: 0.2}
        },
        label: "30 - 40%"
      },
      {
        minValue: 40,
        maxValue: 100,
        symbol: {
          type: "simple-fill",
          color: "#2f5d7d",
          outline: { color: "gray", width: 0.2 }
        },
        label: "40%+"
      }
    ]
  }
});
            map.add (snaptracts);
        
      
        
        var SNAPretailers = new FeatureLayer ({
            portalItem: {
                id: "bd52885ea805408c95a24d2fc76261e8"
            }
        });
        map.add(SNAPretailers);
        
          var markets = new FeatureLayer({
            portalItem: {
                id: "8bf062fb720c48bda8c5f3444b3d10eb"
            }
        });
            map.add (markets);   
        
 //map 2       
        var map2 = new Map({
            basemap: "gray-vector"
        });
        var view2 = new MapView({
            container: "viewDiv2",
            map: map2,
            zoom: 7,
            center: [-82.5, 40],
        });
        
        
        var lowincome = new FeatureLayer({
        portalItem: {
          id: "5a348c1010a8485d9aa8260099f9a816"
        },
          outFields: ["*"],
  title: "Low Income Tracts",
  renderer: {
    type: "class-breaks",
    field: "LowIncomeTracts",
    classBreakInfos: [
      {
        minValue: 0,
        maxValue: 0,
        symbol: {
          type: "simple-fill",
          color: "#ffffff",
          outline: { color: "gray", width: 0.2 }
        },
        label: "No"
      },
      {
        minValue: 1,
        maxValue: 1,
        symbol: {
          type: "simple-fill",
          color: "#ff7c7c",
          outline: { color: "gray", width: 0.2 }
        },
        label: "Yes"
      },
    ]
  }
});
            map2.add (lowincome);
        

        var markets = new FeatureLayer ({
            portalItem: {
                id: "865a4c8c1f4944c396fa2129872e46eb"
        }
        });
        map2.add(markets);
        
//map 3    
        var map3 = new Map({
            basemap: "osm"
        });
        var view3 = new MapView({
            container: "viewDiv3",
            map: map3,
            zoom: 7,
            center: [-82.5, 40],
        });
        
        
         var poverty = new FeatureLayer({
             portalItem: {
          id: "5a348c1010a8485d9aa8260099f9a816"
        },
          outFields: ["*"],
  title: "Poverty Rates",
  renderer: {
    type: "class-breaks",
    field: "PovertyRate",
    classBreakInfos: [
      {
        minValue: 0,
        maxValue: 10,
        symbol: {
          type: "simple-fill",
          color: "#fefefe",
          outline: { color: "gray", width: 0.0 }
        },
        label: "0 - 10%"
      },
      {
        minValue: 10,
        maxValue: 20,
        symbol: {
          type: "simple-fill",
          color: "#ffbdbd",
          outline: { color: "gray", width: 0.0 }
        },
        label: "10 - 20%"
      },
      {
        minValue: 20,
        maxValue: 30,
        symbol: {
          type: "simple-fill",
          color: "#ff6e6e",
          outline: { color: "gray", width: 0.0 }
        },
        label: "20 - 30%"
      },
      {
        minValue: 30,
        maxValue: 40,
        symbol: {
          type: "simple-fill",
          color: "#e62424",
          outline: { color: "gray", width: 0.0 }
        },
        label: "30 - 40%"
      },
      {
        minValue: 40,
        maxValue: 100,
        symbol: {
          type: "simple-fill",
          color: "#a41111",
          outline: { color: "gray", width: 0.0 }
        },
        label: "40%+"
      }
    ]
  }
});
        map3.add (poverty);
        
        
        var LItracts = new FeatureLayer ({
            portalItem: {
                id: "be89421479ac499c84fcf961155d89a3"
        }
        });
        map3.add(LItracts);  
        
          
            var synchronizeView = function(view, others){
                others = Array.isArray(others)? others: [others];
                    var viewpointWatchHandle;
                    var viewStationaryHandle;
                    var otherInteractHandlers;
                    var scheduleId;
                
                    var clear = function(){
                        if (otherInteractHandlers){
                            otherInteractHandlers.forEach(function(handle){
                                handle.remove();
                            });
                        }
                    viewpointWatchHandle && viewpointWatchHandle.remove();
                        viewStationaryHandle && viewStationaryHandle.remove();
                        scheduleId && clearTimeout(scheduleId);
                        otherInteractHandlers = 
                        viewpointWatchHandle=viewStationaryHandle=scheduleId=null;
                    };
                var interactWatcher = 
                    view.watch('interacting,animation',function(newValue){
                        if(!newValue){
                            return;
                        }
                        
                        if(viewpointWatchHandle || scheduleId){
                        return;
                        }
                        
                        scheduleId=setTimeout(function(){
                            scheduleId = null;
                            
                            viewpointWatchHandle=view.watch('viewpoint', function(newValue){
                                others.forEach(function(otherView){
                                    otherView.viewpoint = newValue;
                                });
                            });
                        },0);
                        
                        otherInteractHandlers = others.map(function (otherView) {
  return reactiveUtils.watch(
    () => otherView.interacting || otherView.animation,
    (value) => {
      if (value) {
        clear();
      }
    }
  );
});

                        
               viewStationaryHandle = reactiveUtils.when(
  () => view.stationary === true,
  clear
);

                        
                    });
                return {
                    remove: function() {
                        this.remove = function() {};
                        clear();
                        interactWatcher.remove();
                    }
                }
            };
            
            var synchronizeViews = function(views) {
                var handles = views.map(function(view,idx,views) {
                        var others = views.concat();
                        others.splice(idx, 1);
                        return synchronizeView(view,others);
                    });
                    return {
                        remove: function(){
                            this.remove = function(){};
                            handles.forEach(function(h) {
                                h.remove();
                            });
                            handles = null;
                        }
                    }
            }
            
                synchronizeViews([view,view2, view3]);
        
        
          const layerList = new LayerList({
          container: "legend1",
            view: view,
            listItemCreatedFunction: function(event){
                const item = event.item;
                if(item.layer.type !="group"){
                    item.panel = {
                        content: "legend",
                        open: true
                    };
                }
            }
        });
    
        
         const layerList2 = new LayerList({
          container: "legend2",
            view: view2,
            listItemCreatedFunction: function(event){
                const item = event.item;
                if(item.layer.type !="group"){
                    item.panel = {
                        content: "legend",
                        open: true
                    };
                }
            }
        });
       
        
         const layerList3 = new LayerList({
          container: "legend3",
            view: view3,
            listItemCreatedFunction: function(event){
                const item = event.item;
                if(item.layer.type !="group"){
                    item.panel = {
                        content: "legend",
                        open: true
                    };
                }
            }
        });
      
    });
    </script>
     
    
</head>
<body>
    <div id = "extentDiv">
    <div id = "header"><div id="header1"; style="display: table; height; 15px; overflow: hidden;"><h1 style="verticle-align: middle">Food Access in Appalachian Ohio</h1></div>
    <div id = "titlesDiv"><div id = "legendtitleDiv">Legend</div>
    <div id = "maintitleDiv">SNAP Participation as a Share of the Population</div>
    <div id = "secondarytitleDiv">Low Income Census Tracts</div></div></div>
    <div id = "contentDiv">
        <div id = "legendDiv">
        <div id="legend1"></div>
   <div id="legend2"></div>
   <div id="legend3"></div>
        </div>
        
    <div id = "allviewDiv"><div id = "viewDiv1"></div>
    <div id = "viewDiv"><div id = "viewDiv2"></div>
    <div id = "povertytitleDiv">Poverty Rate by Census Tract</div>
    <div id = "viewDiv3"></div></div></div></div>
        </div>
</body>    
</html>